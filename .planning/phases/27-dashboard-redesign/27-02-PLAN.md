---
phase: 27-dashboard-redesign
plan: 02
type: execute
wave: 2
depends_on: ["27-01"]
files_modified:
  - components/dashboard/action-summary-banner.tsx
  - components/dashboard/kpi-widgets.tsx
autonomous: true

must_haves:
  truths:
    - "Action summary banner shows 'All caught up' when no items need attention"
    - "Action summary banner shows itemized count when items pending"
    - "KPI outcome metrics (reviews, rating, conversion) display large with monthly trend"
    - "KPI pipeline metrics (sends, sequences, pending) display smaller with weekly trend"
    - "KPI cards are clickable and navigate to relevant detail pages"
  artifacts:
    - path: "components/dashboard/action-summary-banner.tsx"
      provides: "Hero banner component"
      exports: ["ActionSummaryBanner"]
    - path: "components/dashboard/kpi-widgets.tsx"
      provides: "Two-tier KPI grid component"
      exports: ["KPIWidgets", "KPIWidgetsSkeleton"]
  key_links:
    - from: "components/dashboard/kpi-widgets.tsx"
      to: "lib/types/dashboard.ts"
      via: "DashboardKPIs type import"
      pattern: "import.*DashboardKPIs"
    - from: "components/dashboard/action-summary-banner.tsx"
      to: "components/dashboard/kpi-widgets.tsx"
      via: "same page layout"
      pattern: "ActionSummaryBanner"
---

<objective>
Build the Action Summary Banner and KPI Widgets components -- the top two sections of the dashboard.

Purpose: The banner answers "Do I need to do anything?" instantly. KPIs provide outcome/pipeline health at a glance. These are the first things users see.
Output: Two client components ready to receive data from the dashboard page.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/27-dashboard-redesign/27-CONTEXT.md
@.planning/phases/27-dashboard-redesign/27-RESEARCH.md
@lib/types/dashboard.ts
@components/ui/card.tsx
@components/ui/badge.tsx
@components/ui/skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Action Summary Banner component</name>
  <files>components/dashboard/action-summary-banner.tsx</files>
  <action>
Create `components/dashboard/action-summary-banner.tsx` as a client component ('use client').

Props: `{ readyCount: number; alertCount: number }`

**All-clear state** (readyCount + alertCount === 0):
- Green-tinted banner: `bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800`
- CheckCircle icon (Phosphor, weight="fill") in green
- Heading: "All caught up -- nothing needs your attention"
- Subtext: "Your automation is running smoothly"
- Non-interactive (no click handler)

**Items pending state** (total > 0):
- Yellow-tinted banner: `bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800`
- WarningCircle icon (Phosphor, weight="fill") in yellow
- Heading: "{total} items need attention" (singular "item" if total === 1)
- Subtext: Build dynamically: "{readyCount} ready to send" and/or "{alertCount} alert(s)"
- Clickable: `onClick` scrolls smoothly to `#ready-to-send-queue` (or `#attention-alerts` if readyCount === 0)
- Hover state: `hover:bg-yellow-100 dark:hover:bg-yellow-950/30 transition-colors`
- ArrowDown icon on the right side (Phosphor)
- Render as a `<button>` with `className="w-full text-left"` for accessibility

Rounded corners: `rounded-lg`. Padding: `p-4`. Margin bottom: `mb-6`.

Import icons from `@phosphor-icons/react`: CheckCircle, WarningCircle, ArrowDown.
  </action>
  <verify>Run `pnpm typecheck` -- no errors.</verify>
  <done>Banner renders correct state based on counts, clickable when items pending, accessible as button element.</done>
</task>

<task type="auto">
  <name>Task 2: Create KPI Widgets component with skeleton</name>
  <files>components/dashboard/kpi-widgets.tsx</files>
  <action>
Create `components/dashboard/kpi-widgets.tsx` as a client component ('use client').

**TrendIndicator subcomponent** (internal, not exported):
- Props: `{ value: number; period: string; size?: 'default' | 'sm' }`
- Show TrendUp (Phosphor) if value >= 0, TrendDown if negative
- Color: green for positive/zero (`text-green-600 dark:text-green-400`), red for negative (`text-red-600 dark:text-red-400`)
- Display: `{Math.abs(value)}% {period}` with appropriate text size
- If value === 0 and there's no meaningful data, show a muted dash instead of "0%"

**KPIWidgets component**:
- Props: `{ data: DashboardKPIs }` (import type from `@/lib/types/dashboard`)
- Two-tier layout per CONTEXT.md:

**Top row -- Outcome metrics (large):**
Grid: `grid-cols-1 md:grid-cols-3 gap-4`

Each card uses `InteractiveCard` from `@/components/ui/card` wrapped in `Link`:
1. Reviews This Month -> href="/history?status=reviewed"
   - Icon: Star (Phosphor), text-4xl font-bold value, TrendIndicator with "vs last month"
2. Average Rating -> href="/feedback"
   - Icon: ChartBar (Phosphor), display as "4.2" format (one decimal), TrendIndicator with "vs last month"
3. Conversion Rate -> href="/history"
   - Icon: Target (Phosphor), display as "23%" format, TrendIndicator with "vs last month"

**Bottom row -- Pipeline metrics (smaller):**
Grid: `grid-cols-1 md:grid-cols-3 gap-3`

Each card uses regular `Card` (not interactive, no link -- pipeline metrics are informational):
1. Requests Sent This Week
   - Smaller: text-2xl value, text-xs label, TrendIndicator size="sm" with "vs last week"
2. Active Sequences
   - Same sizing pattern
3. Pending / Queued
   - Same sizing pattern

Card structure for outcome cards:
```
<InteractiveCard className="p-6">
  <div className="flex items-center justify-between mb-3">
    <h3 className="text-sm font-medium text-muted-foreground">{label}</h3>
    <Icon size={20} weight="regular" className="text-muted-foreground" />
  </div>
  <div className="flex items-baseline gap-2 mb-1">
    <span className="text-4xl font-bold">{formatted value}</span>
    <TrendIndicator ... />
  </div>
</InteractiveCard>
```

Pipeline cards use same structure but: `p-4`, `text-xs` label, `text-2xl` value, TrendIndicator size="sm".

Spacing: `space-y-4 mb-6` between the two rows.

**KPIWidgetsSkeleton component** (exported):
- Mirrors exact layout structure with Skeleton components
- Top row: 3 cards with Skeleton for label (h-4 w-24), value (h-10 w-20), trend (h-3 w-16)
- Bottom row: 3 smaller cards with proportionally smaller skeletons
- Same grid layout as KPIWidgets to prevent layout shift

Import from `@phosphor-icons/react`: Star, ChartBar, Target, TrendUp, TrendDown.
Import from `@/components/ui/card`: Card, InteractiveCard.
Import from `@/components/ui/skeleton`: Skeleton.
Import cn from `@/lib/utils`.
Import Link from `next/link`.
  </action>
  <verify>Run `pnpm typecheck` -- no errors. Verify both KPIWidgets and KPIWidgetsSkeleton are exported.</verify>
  <done>KPI widgets display two-tier hierarchy with correct trend periods, outcome cards are clickable, skeleton matches layout.</done>
</task>

</tasks>

<verification>
- `pnpm typecheck` passes
- ActionSummaryBanner exported from components/dashboard/action-summary-banner.tsx
- KPIWidgets and KPIWidgetsSkeleton exported from components/dashboard/kpi-widgets.tsx
- Banner shows two distinct states (all-clear vs items-pending)
- KPI outcome cards wrapped in Link for navigation
- Skeleton layout matches KPIWidgets layout exactly
</verification>

<success_criteria>
- Banner answers "Do I need to do anything?" at a glance
- Outcome metrics are large (text-4xl) with monthly trends
- Pipeline metrics are smaller (text-2xl) with weekly trends
- All Phosphor icons used consistently with existing codebase pattern
- Dark mode supported via CSS variables and dark: variants
</success_criteria>

<output>
After completion, create `.planning/phases/27-dashboard-redesign/27-02-SUMMARY.md`
</output>
