---
phase: 30.1-audit-gaps
plan: 06
status: complete
started: 2026-02-06T10:14:22Z
completed: 2026-02-06T10:17:06Z
duration: ~3 minutes
subsystem: ux-terminology
tags: [url-params, add-job, terminology, v2-alignment]
requires:
  - Phase 30 (V2 Alignment)
provides:
  - Add Job auto-open via URL param
  - Consistent "Send Message" terminology
affects:
  - User workflow from sidebar
  - Send flow copy consistency
tech-stack:
  added: []
  patterns:
    - URL search params for sheet auto-open
    - useEffect for URL cleanup
key-files:
  created: []
  modified:
    - app/(dashboard)/jobs/page.tsx
    - components/jobs/jobs-client.tsx
    - components/send/quick-send-tab.tsx
    - components/customers/customer-detail-drawer.tsx
    - components/marketing/hero.tsx
    - components/history/request-detail-drawer.tsx
    - components/send/bulk-send-action-bar.tsx
    - components/send/send-page-client.tsx
    - lib/utils/toast.ts
    - components/marketing/v2/animated-demo.tsx
decisions:
  - id: D01
    title: URL param pattern for auto-open
    choice: "Use ?action=add with window.history.replaceState cleanup"
    rationale: "Clean URL after opening prevents re-trigger on refresh"
    alternatives:
      - "Session storage (more complex, not needed)"
      - "No cleanup (bad UX on refresh)"
---

# Phase 30.1 Plan 06: Add Job Auto-Open & Terminology Summary

**One-liner:** Sidebar "Add Job" now auto-opens sheet via URL param; all "Send Request" changed to "Send Message"

## What Was Built

### Task 1: URL Param Auto-Open for Add Job

The sidebar "Add Job" button already linked to `/jobs?action=add`. This plan implemented the receiving side:

1. **Jobs page (server component)** now reads `searchParams.action`
2. **JobsClient** receives `defaultAddJobOpen` prop
3. **useEffect** opens sheet and cleans URL via `window.history.replaceState`

**Flow:**
```
Sidebar "Add Job" click
    -> Navigate to /jobs?action=add
    -> JobsPage reads param, passes defaultAddJobOpen=true
    -> JobsClient useEffect opens sheet
    -> URL cleaned to /jobs (no re-trigger on refresh)
```

### Task 2: "Send Request" -> "Send Message" Terminology

Updated all occurrences of "Send Request" and related terminology:

| Location | Before | After |
|----------|--------|-------|
| Quick send button | "Send Request" | "Send Message" |
| Customer detail drawer | "Send Request" | "Send Message" |
| Hero mockup | "Send Request" | "Send Message" |
| Request detail drawer | "Resend Request" | "Resend Message" |
| Request detail drawer | "Cancel Request" | "Cancel Message" |
| Bulk send action bar | "Send request" | "Send message" |
| Toast messages | "Review request sent" | "Message sent" |
| Animated demo | "Request Sent!" | "Message Sent!" |

## Technical Details

### URL Param Pattern

```typescript
// page.tsx (server component)
interface JobsPageProps {
  searchParams: Promise<{ action?: string }>
}

export default async function JobsPage({ searchParams }: JobsPageProps) {
  const { action } = await searchParams
  const shouldOpenAddJob = action === 'add'
  // ...
}

// jobs-client.tsx (client component)
useEffect(() => {
  if (defaultAddJobOpen) {
    setShowAddSheet(true)
    window.history.replaceState({}, '', '/jobs')
  }
}, [defaultAddJobOpen])
```

## Files Modified

| File | Changes |
|------|---------|
| app/(dashboard)/jobs/page.tsx | Added searchParams reading, pass to client |
| components/jobs/jobs-client.tsx | Added defaultAddJobOpen prop, useEffect handler |
| components/send/quick-send-tab.tsx | Button text + toast message |
| components/customers/customer-detail-drawer.tsx | Button text |
| components/marketing/hero.tsx | Mock button text |
| components/history/request-detail-drawer.tsx | Section headers + buttons |
| components/send/bulk-send-action-bar.tsx | Button text |
| components/send/send-page-client.tsx | Toast message |
| lib/utils/toast.ts | Toast utility functions |
| components/marketing/v2/animated-demo.tsx | Success message |

## Commits

| Hash | Message |
|------|---------|
| 6dc9367 | feat(30.1-06): add URL param auto-open for Add Job sheet |
| 2cf3a9a | fix(30.1-06): update Send Request to Send Message terminology |

## Verification

- [x] `pnpm typecheck` passes
- [x] `pnpm lint` passes
- [x] Sidebar "Add Job" links to /jobs?action=add (pre-existing)
- [x] Jobs page reads ?action=add param
- [x] Add Job sheet auto-opens when param present
- [x] URL cleaned after opening
- [x] All "Send Request" buttons say "Send Message"
- [x] Toast messages say "Message sent"

## Deviations from Plan

### Additional File Updated

**[Rule 2 - Missing Critical] Updated animated-demo.tsx**

- **Found during:** Task 2 verification
- **Issue:** "Request Sent!" text in marketing animated demo
- **Fix:** Changed to "Message Sent!" for consistency
- **File:** components/marketing/v2/animated-demo.tsx

## QA Audit Items Addressed

| ID | Description | Status |
|----|-------------|--------|
| L03-01 | Add Job button auto-open | Complete |
| L08-01 | "Send Request" -> "Send Message" | Complete |
| L08-02 | Toast terminology alignment | Complete |

## Next Phase Readiness

No blockers. Plan 30.1-06 complete.
