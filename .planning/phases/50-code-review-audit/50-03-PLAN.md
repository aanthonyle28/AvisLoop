---
phase: 50-code-review-audit
plan: 03
type: execute
wave: 2
depends_on: ["50-01", "50-02"]
files_modified:
  - docs/CODE-REVIEW-41-44.md
  - .planning/phases/50-code-review-audit/50-03-SUMMARY.md
autonomous: true

must_haves:
  truths:
    - "A comprehensive findings report exists at docs/CODE-REVIEW-41-44.md"
    - "Every finding is categorized by severity (Critical/High/Medium/Low) with file location, line number, and fix recommendation"
    - "Cross-cutting concerns (dead code, design system, accessibility) are covered project-wide across all 41 files"
    - "The report is actionable — Phase 51 can consume it directly to plan remediation"
  artifacts:
    - path: "docs/CODE-REVIEW-41-44.md"
      provides: "Complete severity-rated findings report for Phases 41-44 code review"
      contains: "## Findings"
  key_links:
    - from: "docs/CODE-REVIEW-41-44.md"
      to: "Phase 51 (Audit Remediation)"
      via: "Phase 51 consumes findings report to plan fixes"
---

<objective>
Consolidate findings from Plans 50-01 and 50-02, perform cross-cutting audits (dead code across all files, design system compliance scan, final accessibility sweep), assign final severity ratings, and produce the comprehensive findings report at docs/CODE-REVIEW-41-44.md.

Purpose: This produces the deliverable that Phase 50 exists for — the findings report. Covers AUD-10 (dead code audit), AUD-11 (findings report), and finalizes AUD-05 through AUD-09 with cross-cutting checks.

Output: `docs/CODE-REVIEW-41-44.md` — the complete code review report.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/50-code-review-audit/50-RESEARCH.md
@.planning/phases/50-code-review-audit/50-01-SUMMARY.md
@.planning/phases/50-code-review-audit/50-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Cross-Cutting Audit (Dead Code, Design System, Imports)</name>
  <files>
    All 41 files from Phases 41-44 (grep/scan, not full re-read)
  </files>
  <action>
Perform project-wide scans that complement the file-by-file review from Plans 50-01 and 50-02. These are pattern-based checks across ALL files in scope.

**Dead Code Audit (AUD-10):**

1. **Unused imports scan:** For each of the 41 files, check if there are imports that are never referenced in the file body. Use grep or visual inspection. Common patterns:
   - Imported types only used in removed code
   - Icon imports that were replaced
   - Utility imports from refactored logic

2. **Deprecated alias usage:** Search the codebase for `SendLogWithContact` — all usages should migrate to `SendLogWithCustomer`. Count remaining usages and list files.

3. **Dead exports:** Check if any exports from the 41 files are unused by any importer. Focus on:
   - `RESENDABLE_STATUSES` export from history-columns.tsx — who imports it?
   - Any types exported from database.ts that are unused
   - Any functions exported from action files that are unused

4. **Commented-out code:** Search for blocks of commented code (3+ consecutive lines starting with //) in all 41 files.

5. **Deleted files verification:** Confirm that `software-used-step.tsx` and `contacts/loading.tsx` are actually deleted (not just renamed/moved).

**Design System Compliance (AUD-08):**

1. **Hardcoded colors:** Search for inline color classes that should use semantic tokens:
   - `text-red-*`, `text-green-*`, `bg-red-*`, `bg-green-*` etc. that should be `text-destructive`, `text-success`, etc.
   - Exception: Status indicator colors (sent=green, failed=red) and third-party brand colors (CRM logos) are acceptable.

2. **One-off spacing:** Check for inconsistent padding/margin that deviates from project patterns:
   - Page layout should be `space-y-6` or `space-y-8`
   - Card padding should be `p-6` or `p-4`
   - Gap between related items should be `gap-2` or `gap-3`

3. **Button variant usage:** Verify primary actions use `variant="default"`, secondary use `variant="outline"` or `variant="soft"`, destructive use `variant="destructive"`.

4. **Icon library consistency:** Any Lucide icons introduced in Phases 41-44 that should be Phosphor? (Project is migrating to Phosphor.)

**Final Accessibility Sweep:**
- Count: how many icon-only buttons across all 41 files lack `aria-label`?
- Count: how many form inputs lack associated labels?
- Count: how many interactive elements have touch targets below 44px?

Record all cross-cutting findings with severity, file paths, and recommendations.
  </action>
  <verify>
- Dead code audit complete: unused imports listed, deprecated aliases counted, dead exports identified
- Design system scan complete: hardcoded colors found (with exceptions noted), spacing checked, button variants checked
- Accessibility sweep complete: counts for aria-label gaps, label gaps, touch target violations
  </verify>
  <done>
Cross-cutting audit findings recorded. Dead code, design system, and accessibility gaps quantified with specific file locations.
  </done>
</task>

<task type="auto">
  <name>Task 2: Write Consolidated Findings Report (docs/CODE-REVIEW-41-44.md)</name>
  <files>
    docs/CODE-REVIEW-41-44.md
  </files>
  <action>
Merge all findings from:
1. Plan 50-01 SUMMARY (Phases 41-43 UI component findings)
2. Plan 50-02 SUMMARY (Phase 44 onboarding and data layer findings)
3. Task 1 cross-cutting audit findings

Write `docs/CODE-REVIEW-41-44.md` with this structure:

```markdown
# Code Review: Phases 41-44 (v2.5.1 Bug Fixes & Polish)

**Review date:** 2026-02-25
**Reviewer:** Claude (automated code review)
**Scope:** 41 files across 4 phases (6,889 lines)
**Methodology:** File-by-file review + cross-cutting audits

## Executive Summary

[2-3 sentences: overall code quality assessment, number of findings by severity, top concerns]

## Findings by Severity

### Critical
[Table: ID | File | Line(s) | Description | Recommendation]
(If none, state "No critical findings.")

### High
[Table: same format]

### Medium
[Table: same format]

### Low
[Table: same format]

## Phase-by-Phase Summary

### Phase 41: Activity Page Overhaul
[Brief assessment, reference finding IDs]

### Phase 42: Dashboard & Navigation Polish
[Brief assessment, reference finding IDs]

### Phase 43: Cross-Page Consistency
[Brief assessment, reference finding IDs]

### Phase 44: Onboarding & Services
[Brief assessment, reference finding IDs]

## Cross-Cutting Concerns

### Dead Code
[Summary of unused imports, deprecated aliases, dead exports]

### Design System Compliance
[Summary of hardcoded colors, spacing deviations, icon library mix]

### Accessibility
[Summary of aria-label gaps, touch target violations]

### Security
[Summary of server action validation, auth patterns, RLS compliance]

### Performance
[Summary of query patterns, rendering efficiency]

### V2 Alignment
[Summary of any V1 pattern regressions or V2 alignment gaps]

## Remediation Priority

[Ordered list of what Phase 51 should fix first, grouped by effort/impact]

## Appendix: Files Reviewed

[Complete list of all 41 files with line counts and review status]
```

**Severity definitions for consistent rating:**
- **Critical:** Security vulnerability, data loss risk, or broken functionality affecting users in production
- **High:** Significant bug, accessibility violation blocking users, or architectural concern that will compound
- **Medium:** Code quality issue, missing validation, or UX inconsistency that should be fixed but doesn't block users
- **Low:** Style inconsistency, minor dead code, documentation gap, or nitpick that improves maintainability

**Important:** Every finding must have a unique ID (e.g., F-01, F-02...) for Phase 51 to reference. Findings from research red flags (RF-1 through RF-6) should be incorporated with their confirmed severity and exact line numbers.

After writing the report, also create the plan SUMMARY.
  </action>
  <verify>
- `docs/CODE-REVIEW-41-44.md` exists and is well-formed
- Every finding has a unique ID, severity, file, line number, description, and recommendation
- Executive summary accurately reflects the findings
- Remediation priority section gives Phase 51 a clear starting point
- All 41 files listed in appendix
- `pnpm lint` still passes (no source changes made, but verify report file is valid markdown)
  </verify>
  <done>
`docs/CODE-REVIEW-41-44.md` contains the complete, consolidated findings report. Every finding is severity-rated with actionable fix recommendations. Phase 51 can consume this report directly to plan remediation. SUMMARY written.
  </done>
</task>

</tasks>

<verification>
- [ ] Cross-cutting dead code audit complete (unused imports, deprecated aliases, dead exports, commented code)
- [ ] Cross-cutting design system audit complete (hardcoded colors, spacing, button variants, icon library)
- [ ] Cross-cutting accessibility audit complete (aria-label gaps, label gaps, touch targets)
- [ ] All findings from 50-01 and 50-02 incorporated into report
- [ ] Every finding has unique ID, severity, file, line number, description, recommendation
- [ ] Report has executive summary, phase-by-phase summary, cross-cutting concerns, remediation priority
- [ ] All 41 files listed in appendix with review status
- [ ] docs/CODE-REVIEW-41-44.md written and committed
</verification>

<success_criteria>
docs/CODE-REVIEW-41-44.md is the complete deliverable of Phase 50. It contains every finding from the code review, severity-rated, with actionable recommendations. Phase 51 can read this file and plan remediation without any other context. Requirements AUD-10, AUD-11 fully covered. All AUD requirements (01-11) satisfied across Plans 50-01, 50-02, and 50-03.
</success_criteria>

<output>
After completion, create `.planning/phases/50-code-review-audit/50-03-SUMMARY.md`
</output>
