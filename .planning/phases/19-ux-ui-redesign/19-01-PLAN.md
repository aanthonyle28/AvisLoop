---
phase: 19-ux-ui-redesign
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/layout/sidebar.tsx
  - components/layout/bottom-nav.tsx
  - components/layout/app-shell.tsx
  - components/layout/page-header.tsx
  - app/(dashboard)/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Desktop sidebar shows exactly 3 nav items: Send, Contacts, Requests"
    - "Desktop sidebar has account dropdown menu at bottom (not sign-out button)"
    - "Account menu contains: Apps/Integrations, Settings, Billing, Help & Support, Logout"
    - "Mobile bottom nav shows exactly 3 items: Send, Contacts, Requests"
    - "Mobile pages show avatar/account button in top-right header"
    - "Sidebar logo links to /send (not /dashboard)"
  artifacts:
    - path: "components/layout/sidebar.tsx"
      provides: "3-item nav + account dropdown"
      contains: "DropdownMenu"
    - path: "components/layout/bottom-nav.tsx"
      provides: "3-item mobile nav"
      contains: "grid-cols-3"
    - path: "components/layout/page-header.tsx"
      provides: "Mobile page header with account button"
      exports: ["PageHeader"]
    - path: "components/layout/app-shell.tsx"
      provides: "Layout wrapper with PageHeader on mobile"
  key_links:
    - from: "components/layout/sidebar.tsx"
      to: "@radix-ui/react-dropdown-menu"
      via: "Account menu dropdown"
      pattern: "DropdownMenu"
    - from: "components/layout/app-shell.tsx"
      to: "components/layout/page-header.tsx"
      via: "Mobile header rendering"
      pattern: "PageHeader"
---

<objective>
Rebuild the navigation and layout shell to the new 3-page IA: Send, Contacts, Requests.

Purpose: Navigation is the foundation every other plan depends on. The new IA removes Dashboard, Scheduled, and History as separate nav items, replacing them with Send (home), Contacts, and Requests. The account menu moves from secondary nav items to a dropdown anchored at the sidebar bottom.

Output: Updated sidebar (3 nav + account dropdown), updated bottom nav (3 items), new mobile page header component with account button, updated app shell and dashboard layout.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/19-ux-ui-redesign/19-CONTEXT.md
@.planning/phases/19-ux-ui-redesign/19-RESEARCH.md
@components/layout/sidebar.tsx
@components/layout/bottom-nav.tsx
@components/layout/app-shell.tsx
@app/(dashboard)/layout.tsx
@components/ui/dropdown-menu.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rebuild Sidebar and Bottom Nav</name>
  <files>
    components/layout/sidebar.tsx
    components/layout/bottom-nav.tsx
  </files>
  <action>
**Sidebar (sidebar.tsx):**
- Replace `mainNav` array with 3 items:
  1. `{ icon: PaperPlaneTilt, label: 'Send', href: '/send' }`
  2. `{ icon: AddressBook, label: 'Contacts', href: '/contacts' }`
  3. `{ icon: ClockCounterClockwise, label: 'Requests', href: '/history' }` (keep `/history` route, just rename label)
- Remove `secondaryNav` array entirely
- Remove the `scheduledCount` prop and badge logic (Scheduled page removed from nav)
- Replace the footer sign-out button with an account dropdown menu using Radix DropdownMenu:
  - Trigger: User avatar circle (initials or UserCircle icon) + user name (when expanded) / just avatar (when collapsed)
  - Menu positioned with `side="top"` and `align="start"` (Claude account menu style, pops up from bottom)
  - Menu items: Apps/Integrations (link to /dashboard/settings), Settings (link to /dashboard/settings), Billing (link to /billing), Help & Support (disabled/placeholder), separator, Logout (form action calling signOut)
  - Style the menu with consistent spacing, icons for each item (AppWindow, GearSix, CreditCard, Headset, SignOut from Phosphor)
- Update logo link from `/dashboard` to `/send`
- Keep collapsible behavior, auto-collapse on medium screens, useLocalStorage persistence

**Bottom Nav (bottom-nav.tsx):**
- Replace `items` array with same 3 items as sidebar (Send, Contacts, Requests)
- Change grid from `grid-cols-5` to `grid-cols-3`
- Remove `scheduledCount` prop and badge logic
- Keep all existing styling (fixed bottom, backdrop blur, active states)
  </action>
  <verify>
- `pnpm typecheck` passes with no errors
- `pnpm lint` passes
- Visual: Desktop sidebar shows 3 nav items + account dropdown at bottom
- Visual: Mobile bottom nav shows 3 items, evenly spaced
  </verify>
  <done>Sidebar has 3 nav items and account dropdown menu. Bottom nav has 3 items in 3-column grid. No TypeScript errors.</done>
</task>

<task type="auto">
  <name>Task 2: Create Mobile Page Header and Update App Shell</name>
  <files>
    components/layout/page-header.tsx
    components/layout/app-shell.tsx
    app/(dashboard)/layout.tsx
  </files>
  <action>
**New PageHeader (page-header.tsx):**
- Create a new `'use client'` component for mobile page headers
- Props: `title?: string` (optional, pages can set their own)
- Layout: `flex items-center justify-between` with height matching sidebar header (h-16)
- Left side: Page title (or AvisLoop logo on mobile when no title)
- Right side: Account avatar button (same UserCircle icon from Phosphor)
- Account button opens same DropdownMenu as sidebar (extract shared menu items to a constant or shared component to avoid duplication)
- Only visible on mobile: wrap in `md:hidden` class
- Style: `bg-white dark:bg-card border-b` matching sidebar header aesthetic

**Extract shared account menu:**
- Create a shared `AccountMenu` sub-component (can be in sidebar.tsx or a new file `components/layout/account-menu.tsx`) that both sidebar footer and PageHeader use
- Takes `side` prop to control popover direction (top for sidebar, bottom for mobile header)

**App Shell (app-shell.tsx):**
- Remove `scheduledCount` prop (no longer needed)
- Update Sidebar usage (remove scheduledCount)
- Update BottomNav usage (remove scheduledCount)

**Dashboard Layout (app/(dashboard)/layout.tsx):**
- Remove `getPendingScheduledCount` fetch (no longer needed for nav badge)
- Simplify to just render `<AppShell>{children}</AppShell>` without Suspense wrapper for scheduled count
  </action>
  <verify>
- `pnpm typecheck` passes
- `pnpm lint` passes
- `pnpm build` completes without errors (checks server/client boundary correctness)
  </verify>
  <done>Mobile page header with account button exists. App shell no longer fetches/passes scheduledCount. Account menu is shared between sidebar and mobile header. Build passes.</done>
</task>

</tasks>

<verification>
- Desktop: Sidebar shows Send, Contacts, Requests nav items
- Desktop: Account dropdown at sidebar bottom opens with Apps, Settings, Billing, Help, Logout
- Mobile: Bottom nav shows 3 centered items
- Mobile: Page header visible with account button in top-right
- All existing pages still render correctly (no broken imports)
- `pnpm typecheck && pnpm lint` both pass
</verification>

<success_criteria>
Navigation reduced from 5+4 items to 3+account menu. Mobile has 3-item bottom nav and top-right account button. Layout shell simplified (no scheduledCount dependency). Build passes without errors.
</success_criteria>

<output>
After completion, create `.planning/phases/19-ux-ui-redesign/19-01-SUMMARY.md`
</output>
