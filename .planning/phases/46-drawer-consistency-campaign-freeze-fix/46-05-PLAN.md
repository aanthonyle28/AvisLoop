---
phase: 46-drawer-consistency-campaign-freeze-fix
plan: 46-05
title: "Apply drawer consistency to Job Detail and Customer Detail drawers"
wave: 2
depends_on: [46-03]
files_modified:
  - components/jobs/job-detail-drawer.tsx
  - components/customers/customer-detail-drawer.tsx
autonomous: true
---

## Objective

Apply the drawer consistency pattern to the two detail drawers: Job Detail and Customer Detail. Each drawer gets: (1) `SheetBody` for scrollable content, (2) `SheetFooter` for sticky action buttons, (3) all `<Separator />` components removed (replaced by `space-y-6` gaps), (4) `overflow-y-auto` removed from `SheetContent`, and (5) Job Detail button patterns normalized to match Customer Detail's variant usage (primary for main action, outline for secondary).

## Context

@components/ui/sheet.tsx (SheetBody, SheetFooter with shrink-0 — created in 46-03)
@components/jobs/job-detail-drawer.tsx (full file — 671 lines, sm:max-w-lg, 4 Separators, action buttons all variant="outline" with color overrides)
@components/customers/customer-detail-drawer.tsx (full file — 300 lines, sm:max-w-lg, 4 Separators, action buttons: Send=default, Edit=outline, Archive=outline, History=ghost)
@components/history/request-detail-drawer.tsx (REFERENCE — no Separators, uses `<div className="mt-6 space-y-6">` for sections)
@.planning/phases/46-drawer-consistency-campaign-freeze-fix/46-RESEARCH.md (Patterns 2-4, DRW-01/02/03)

## Tasks

<task id="1">
Update `components/jobs/job-detail-drawer.tsx`.

**Import changes:**
- Add `SheetBody` and `SheetFooter` to the import from `@/components/ui/sheet`
- Remove `Separator` from imports (line 12: `import { Separator } from '@/components/ui/separator'`)

**SheetContent change (line 482):**
Change `<SheetContent side="right" className="sm:max-w-lg overflow-y-auto">` to `<SheetContent side="right" className="sm:max-w-lg">`.
Remove `overflow-y-auto` — scrolling is now handled by `SheetBody`.

**Structure change:** Split the content at line 490-634 into scrollable body + sticky footer.

The current structure is:
```tsx
<div className="mt-6 space-y-6">
  {/* Customer Section */}
  <Separator />
  {/* Job Info Grid */}
  <Separator />
  {/* Campaign Section */}
  <Separator />
  {/* Notes Section */}
  <Separator />
  {/* Action Buttons */}
</div>
```

Change to:
```tsx
<SheetBody>
  <div className="space-y-6">
    {/* Customer Section — same content, no changes */}
    {/* Job Info Grid — same content, no changes */}
    {/* Campaign Section — same content, no changes */}
    {/* Notes Section — same content, no changes */}
  </div>
</SheetBody>

<SheetFooter>
  {/* Action Buttons — moved here, restructured */}
</SheetFooter>
```

Key changes:
1. Remove all 4 `<Separator />` components (lines 527, 575, 583, 595)
2. Remove the outer `<div className="mt-6 space-y-6">` wrapper — replaced by `<SheetBody>` + inner `<div className="space-y-6">`
3. Move the action buttons `<div className="space-y-2">` (lines 598-633) into `<SheetFooter>`
4. The `space-y-6` gap between sections provides natural visual separation

**Button variant normalization (DRW-03):**

Current Job Detail buttons are ALL `variant="outline"` with custom color overrides — this is inconsistent with Customer Detail where the primary action uses `variant="default"`.

Change the buttons inside `<SheetFooter>`:

**Complete button (for scheduled jobs) — make it the primary action:**
```tsx
{job.status === 'scheduled' && (
  <Button
    onClick={handleMarkComplete}
    disabled={isCompleting}
    className="w-full justify-start"
  >
    {isCompleting ? (
      <CircleNotch size={14} className="mr-1 animate-spin" />
    ) : (
      <CheckCircle size={14} weight="fill" className="mr-1" />
    )}
    {isCompleting ? 'Completing...' : 'Complete'}
  </Button>
)}
```
Changed from `variant="outline"` with custom `text-success-foreground border-success/40 hover:bg-success-bg` overrides to `variant="default"` (which is the implicit default — no variant prop needed). This makes "Complete" the primary CTA, matching how "Send Message" is the primary CTA in Customer Detail.

**Edit button — keep as outline:**
```tsx
<Button
  onClick={() => { onOpenChange(false); onEdit(job) }}
  variant="outline"
  className="w-full justify-start"
>
  <PencilSimple size={16} className="mr-2" />
  Edit Job
</Button>
```
No change to this button.

**Delete button — keep as outline with destructive styling:**
```tsx
<Button
  onClick={handleDelete}
  variant="outline"
  className="w-full justify-start text-destructive hover:text-destructive"
>
  <Trash size={16} className="mr-2" />
  Delete Job
</Button>
```
No change to this button — the destructive text color is fine on outline.

**Conflict resolution buttons** (inside the Campaign section, around lines 200-400): These are contextual buttons that appear within the campaign section content — they stay in the body, NOT in the footer. They are not drawer-level actions. Do NOT move them. Leave them exactly where they are inside `<SheetBody>`.
</task>

<task id="2">
Update `components/customers/customer-detail-drawer.tsx`.

**Import changes:**
- Add `SheetBody` and `SheetFooter` to the import from `@/components/ui/sheet`
- Remove `Separator` from imports (line 14: `import { Separator } from '@/components/ui/separator'`)

**SheetContent change (line 132):**
Change `<SheetContent side='right' className='sm:max-w-lg overflow-y-auto'>` to `<SheetContent side='right' className='sm:max-w-lg'>`.

**Structure change:** Split content at lines 140-295 into scrollable body + sticky footer.

Current structure:
```tsx
<div className='mt-6 space-y-6'>
  {/* Contact Info */}
  <Separator />
  {/* Notes Field */}
  <Separator />
  {/* SMS Consent Status */}
  <Separator />
  {/* Activity Summary */}
  <Separator />
  {/* Action Buttons */}
</div>
```

Change to:
```tsx
<SheetBody>
  <div className='space-y-6'>
    {/* Contact Info — same content */}
    {/* Notes Field — same content */}
    {/* SMS Consent Status — same content (includes inline SmsConsentForm for 'unknown' status) */}
    {/* Activity Summary — same content */}
  </div>
</SheetBody>

<SheetFooter>
  {/* Action Buttons — moved here */}
  <Button onClick={() => onSend(customer)} className='w-full justify-start'>
    <PaperPlaneRight className='mr-2 h-4 w-4' />
    Send Message
  </Button>
  <Button onClick={() => onEdit(customer)} variant='outline' className='w-full justify-start'>
    <PencilSimple className='mr-2 h-4 w-4' />
    Edit Customer
  </Button>
  <Button onClick={() => onArchive(customer.id)} variant='outline' className='w-full justify-start'>
    <Archive className='mr-2 h-4 w-4' />
    Archive
  </Button>
  <Button onClick={() => onViewHistory(customer.id)} variant='ghost' className='w-full justify-start'>
    <ClockCounterClockwise className='mr-2 h-4 w-4' />
    View History
  </Button>
</SheetFooter>
```

Key changes:
1. Remove all 4 `<Separator />` components (lines 168, 187, 234, 259)
2. Remove the outer `<div className='mt-6 space-y-6'>` wrapper — replaced by `<SheetBody>` + inner `<div className='space-y-6'>`
3. Move the 4 action buttons (lines 262-294) into `<SheetFooter>`
4. Button variants unchanged — Send=default, Edit=outline, Archive=outline, History=ghost (this IS the reference pattern)
5. `SheetFooter` already has `flex flex-col gap-2` so stacked buttons work naturally
</task>

## Verification

After all tasks:

1. `pnpm typecheck` passes
2. `pnpm lint` passes
3. Neither file imports `Separator` (grep for `import.*Separator` in both files should return 0 matches)
4. Neither file contains `<Separator` JSX (grep for `<Separator` should return 0 matches)
5. Both files import `SheetBody` and `SheetFooter`
6. Neither file has `overflow-y-auto` on `SheetContent`
7. Job Detail: "Complete" button uses default variant (no `variant="outline"`, no custom color overrides like `text-success-foreground` or `border-success`)
8. Customer Detail: Button variants unchanged (Send=default, Edit=outline, Archive=outline, History=ghost)
9. Conflict resolution buttons in Job Detail are still in the body (inside `<SheetBody>`), not in the footer

## must_haves

- [ ] Both drawers (Job Detail, Customer Detail) use `SheetBody` for scrollable content and `SheetFooter` for sticky action buttons
- [ ] All `<Separator />` components removed from both drawers — sections separated by `space-y-6` gap only
- [ ] Job Detail "Complete" button uses default variant (primary action), not outline with color overrides — consistent with Customer Detail's "Send Message" as primary
- [ ] All drawer action buttons remain visible at the bottom without scrolling — footer is sticky regardless of content height
- [ ] `pnpm typecheck` and `pnpm lint` pass
