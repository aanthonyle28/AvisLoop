---
phase: 35-card-variants-dashboard-quick-wins
plan: 03
type: execute
wave: 2
depends_on: ["35-01"]
files_modified:
  - app/(dashboard)/dashboard/page.tsx
  - components/dashboard/kpi-widgets.tsx
  - components/layout/sidebar.tsx
  - components/dashboard/analytics-service-breakdown.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard shows 'Good morning/afternoon/evening, [FirstName]' greeting at the top"
    - "Top 3 KPI cards use amber variant with visible arrow affordance"
    - "Bottom 3 pipeline cards use subtle variant and are visually distinct from top cards"
    - "Dashboard notification badge is not shown on the sidebar Dashboard nav item"
    - "Analytics service breakdown empty state shows icon, heading, and 'Add your first job' CTA"
  artifacts:
    - path: "app/(dashboard)/dashboard/page.tsx"
      provides: "Time-of-day greeting with user's first name"
      contains: "getGreeting"
    - path: "components/dashboard/kpi-widgets.tsx"
      provides: "Amber variant on top InteractiveCards, subtle variant on bottom Cards"
      contains: "variant=\"amber\""
    - path: "components/layout/sidebar.tsx"
      provides: "Badge removed from Dashboard nav item"
    - path: "components/dashboard/analytics-service-breakdown.tsx"
      provides: "Proper empty state with icon, heading, CTA"
      contains: "ChartBar"
  key_links:
    - from: "app/(dashboard)/dashboard/page.tsx"
      to: "lib/supabase/server"
      via: "createClient + getUser for first name"
      pattern: "supabase.auth.getUser"
    - from: "components/dashboard/kpi-widgets.tsx"
      to: "components/ui/card.tsx"
      via: "variant prop on Card/InteractiveCard"
      pattern: "variant=\"amber\""
---

<objective>
Add a personalized time-of-day greeting to the dashboard, differentiate top/bottom KPI card rows using card variants, remove the dashboard notification badge from the sidebar, and improve the analytics empty state.

Purpose: Delivers the dashboard quick wins (DASH-01, DASH-02, DASH-03, DASH-04, PG-01) that make the dashboard feel polished and personalized.
Output: Updated dashboard page, KPI widgets, sidebar, and analytics components.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/35-card-variants-dashboard-quick-wins/35-01-SUMMARY.md
@app/(dashboard)/dashboard/page.tsx
@components/dashboard/kpi-widgets.tsx
@components/layout/sidebar.tsx
@components/dashboard/analytics-service-breakdown.tsx
@lib/actions/auth.ts (line 44 — full_name stored in user_metadata at sign-up)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add dashboard greeting and apply card variants to KPI widgets</name>
  <files>app/(dashboard)/dashboard/page.tsx, components/dashboard/kpi-widgets.tsx</files>
  <action>
    **Dashboard page (dashboard/page.tsx):**

    1. Add import: `import { createClient } from '@/lib/supabase/server'`
    2. Inside `DashboardPage()`, after the business redirect check, add user fetch:
       ```ts
       const supabase = await createClient()
       const { data: { user } } = await supabase.auth.getUser()
       ```
    3. Extract first name:
       ```ts
       const fullName = (user?.user_metadata?.full_name as string | undefined) ?? ''
       const firstName = fullName.split(' ')[0] || ''
       ```
    4. Create greeting function (inline or above the component):
       ```ts
       function getGreeting(): string {
         const hour = new Date().getHours()
         if (hour < 12) return 'Good morning'
         if (hour < 17) return 'Good afternoon'
         return 'Good evening'
       }
       ```
       Note: This runs in server timezone (UTC on Vercel), which is acceptable per CONTEXT.md decision.
    5. Replace the current `<h1>Dashboard</h1>` with:
       ```tsx
       <div>
         <h1 className="text-2xl font-bold">
           {firstName ? `${getGreeting()}, ${firstName}` : getGreeting()}
         </h1>
         <p className="text-sm text-muted-foreground mt-1">Here&apos;s your overview for today</p>
       </div>
       ```

    **KPI widgets (kpi-widgets.tsx):**

    1. Apply `variant="amber"` to each of the 3 `<InteractiveCard>` elements in the top row. They currently have `className="p-6"` — keep the className, just add the variant prop: `<InteractiveCard variant="amber" className="p-6">`

    2. Apply `variant="subtle"` to each of the 3 `<Card>` elements in the bottom row. They currently have `className="p-4"` — keep the className, just add the variant prop: `<Card variant="subtle" className="p-4">`

    This creates clear visual hierarchy: amber-tinted hero cards on top with arrow indicators, subdued muted cards on bottom.
  </action>
  <verify>
    `pnpm typecheck` — must pass. Verify no type errors from variant prop usage on Card/InteractiveCard.
  </verify>
  <done>
    - Dashboard shows "Good morning/afternoon/evening, [FirstName]" with subtitle
    - Top 3 KPI cards are amber-tinted with arrow affordance
    - Bottom 3 pipeline cards use subtle variant (bg-muted, border-border/50)
    - Clear visual hierarchy between outcome and pipeline metrics
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove dashboard badge and fix analytics empty state</name>
  <files>components/layout/sidebar.tsx, components/dashboard/analytics-service-breakdown.tsx</files>
  <action>
    **Sidebar badge removal (sidebar.tsx):**

    In sidebar.tsx around line 157, change the badge assignment for Dashboard nav item.

    Current code (approximately):
    ```tsx
    badge: item.label === 'Dashboard' ? dashboardBadge : undefined,
    ```

    Change to:
    ```tsx
    badge: undefined,
    ```

    This removes the badge from ALL nav items (only Dashboard had one). The `dashboardBadge` prop still flows through from layout.tsx — do NOT remove it from the prop chain, as it may be used by the notification bell. Only the nav item badge display is removed.

    **Analytics empty state (analytics-service-breakdown.tsx):**

    Replace the bare `<p>` empty state (lines 12-17) with the project-standard empty state pattern.

    1. Add imports at top:
       ```ts
       import { ChartBar } from '@phosphor-icons/react'
       import Link from 'next/link'
       import { Button } from '@/components/ui/button'
       ```

    2. Replace the empty state return with:
       ```tsx
       if (data.byServiceType.length === 0) {
         return (
           <div className="flex flex-col items-center justify-center py-16 px-4 text-center">
             <div className="rounded-full bg-muted p-6 mb-6">
               <ChartBar size={32} weight="regular" className="text-muted-foreground" />
             </div>
             <h2 className="text-xl font-semibold tracking-tight mb-2">
               No analytics data yet
             </h2>
             <p className="text-muted-foreground mb-6 max-w-sm">
               Analytics appear once campaigns start sending. Complete a job to kick off your first campaign.
             </p>
             <Link href="/jobs?action=add">
               <Button>Add your first job</Button>
             </Link>
           </div>
         )
       }
       ```
  </action>
  <verify>
    `pnpm lint && pnpm typecheck` — both must pass.
  </verify>
  <done>
    - Sidebar Dashboard nav item shows no badge number
    - Analytics empty state shows ChartBar icon, heading, descriptive text, and "Add your first job" CTA button
    - Both match established project patterns (badge assignment pattern, empty state pattern from UX Audit)
  </done>
</task>

</tasks>

<verification>
1. `pnpm typecheck` passes
2. `pnpm lint` passes
3. `grep "getGreeting" app/(dashboard)/dashboard/page.tsx` shows greeting function exists
4. `grep "variant=\"amber\"" components/dashboard/kpi-widgets.tsx` shows top cards use amber variant
5. `grep "variant=\"subtle\"" components/dashboard/kpi-widgets.tsx` shows bottom cards use subtle variant
6. `grep "dashboardBadge" components/layout/sidebar.tsx` shows the prop still exists but `grep "badge:" components/layout/sidebar.tsx` shows badge is undefined
7. `grep "ChartBar" components/dashboard/analytics-service-breakdown.tsx` shows icon import and usage
</verification>

<success_criteria>
- Dashboard page shows personalized time-of-day greeting with first name from auth session
- Top 3 KPI cards visually distinct (amber tint + arrow) from bottom 3 (subtle/muted)
- No notification badge on Dashboard nav item in sidebar
- Analytics empty state has icon, heading, and actionable CTA
- Build passes (lint + typecheck)
</success_criteria>

<output>
After completion, create `.planning/phases/35-card-variants-dashboard-quick-wins/35-03-SUMMARY.md`
</output>
