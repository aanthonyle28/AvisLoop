---
phase: 40-dashboard-command-center
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/types/dashboard.ts
  - components/dashboard/right-panel.tsx
  - components/dashboard/dashboard-shell.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard page can render a two-column layout with left (flexible) and right (~360px fixed) columns on lg+ screens"
    - "Right panel has a state machine with mutually exclusive views: default, job-detail, attention-detail, getting-started"
    - "Panel state can be set and cleared via React state management"
  artifacts:
    - path: "lib/types/dashboard.ts"
      provides: "RightPanelView union type and RightPanelState interface"
      contains: "RightPanelView"
    - path: "components/dashboard/right-panel.tsx"
      provides: "RightPanel shell component with slide animation and close button"
      contains: "RightPanel"
    - path: "components/dashboard/dashboard-shell.tsx"
      provides: "Two-column layout wrapper with left column and right panel"
      contains: "DashboardShell"
  key_links:
    - from: "components/dashboard/dashboard-shell.tsx"
      to: "components/dashboard/right-panel.tsx"
      via: "renders RightPanel as fixed-width column"
      pattern: "RightPanel"
    - from: "components/dashboard/right-panel.tsx"
      to: "lib/types/dashboard.ts"
      via: "imports RightPanelState type"
      pattern: "RightPanelState"
---

<objective>
Create the foundational two-column layout shell and right panel architecture for the dashboard command center.

Purpose: All subsequent plans depend on the two-column layout and panel state machine existing. This plan creates the structural foundation without modifying existing components.
Output: New DashboardShell layout component, RightPanel component with state machine, and updated TypeScript types.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/40-dashboard-command-center/40-CONTEXT.md

# Key source files to understand current structure:
@app/(dashboard)/dashboard/page.tsx
@lib/types/dashboard.ts
@components/dashboard/kpi-widgets.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add right panel types to dashboard types</name>
  <files>lib/types/dashboard.ts</files>
  <action>
Add the following types to the BOTTOM of lib/types/dashboard.ts (do NOT remove or modify existing types):

```typescript
// Right panel state machine for dashboard command center
export type RightPanelView =
  | { type: 'default' }
  | { type: 'job-detail'; jobId: string }
  | { type: 'attention-detail'; alertId: string }
  | { type: 'getting-started' }

// Props for items that can be selected in left column lists
export interface SelectableJobItem {
  id: string
  customerName: string
  serviceType: string
  completedAt: string
  campaignName: string | null
}

export interface SelectableAlertItem {
  id: string
  type: AlertType
  severity: AlertSeverity
  title: string
  description: string
  customerName: string
  timestamp: string
  // For failed sends
  retryable?: boolean
  sendLogId?: string
  errorMessage?: string
  // For feedback
  feedbackId?: string
  rating?: number
  feedbackText?: string
}
```

These types power the right panel state machine and the item selection interface between left column and right panel.
  </action>
  <verify>Run `pnpm typecheck` — should pass with no errors related to dashboard.ts</verify>
  <done>RightPanelView union type and SelectableJobItem/SelectableAlertItem interfaces exist in lib/types/dashboard.ts</done>
</task>

<task type="auto">
  <name>Task 2: Create DashboardShell two-column layout and RightPanel component</name>
  <files>components/dashboard/dashboard-shell.tsx, components/dashboard/right-panel.tsx</files>
  <action>
**Create `components/dashboard/right-panel.tsx`:**

A 'use client' component that renders the right panel container with:
- Fixed width of ~360px on lg+ screens (`w-[360px] shrink-0`)
- Left border separator (`border-l border-border`)
- Full height, overflow-y-auto for scrolling
- Accepts `panelView: RightPanelView` and `onClose: () => void` props
- When panelView.type !== 'default', renders a sticky header bar at top with:
  - Back arrow or X button (using Phosphor `X` icon) on the right
  - `onClick={onClose}` to return to default view
  - Small title text based on view type ("Job Details", "Alert Details", "Getting Started")
- Content area renders `children` prop (the actual content is provided by parent — this is just the shell)
- Slide-from-right animation using Tailwind: when transitioning from default to detail view, use `transition-transform duration-200 ease-out`. The detail content slides in from right. Use a simple approach: wrap children in a div with key={panelView.type} and use CSS transition (or just render conditionally — animation is Claude's discretion per CONTEXT.md).
- Hide completely on screens below lg breakpoint (`hidden lg:flex lg:flex-col`)

Export: `RightPanel`

**Create `components/dashboard/dashboard-shell.tsx`:**

A 'use client' component that provides the two-column layout:
- Uses React useState to manage `panelView: RightPanelView` (default: `{ type: 'default' }`)
- Renders a flex container: `flex gap-0 h-full`
- Left column: `flex-1 min-w-0 overflow-y-auto` — renders children via render prop or context
- Right column: `<RightPanel>` with the fixed width
- Provides panel state management via React Context:
  - `DashboardPanelContext` with value `{ panelView, setPanelView, closePanel }`
  - `closePanel` sets view back to `{ type: 'default' }`
  - `useDashboardPanel()` custom hook for consuming context
- Export: `DashboardShell`, `DashboardPanelProvider`, `useDashboardPanel`

The DashboardShell accepts these props:
- `children: React.ReactNode` — left column content
- `defaultContent: React.ReactNode` — right panel default view (KPIs + activity)
- `detailContent: React.ReactNode | null` — right panel detail view (job or alert details)
- `gettingStartedContent?: React.ReactNode` — right panel getting started view

The RightPanel internally switches between these based on panelView.type:
- 'default' → renders defaultContent
- 'job-detail' or 'attention-detail' → renders detailContent (with close button header)
- 'getting-started' → renders gettingStartedContent (with close button header)

Use the existing design system: `bg-card` background for the panel, `border-border` for the left border, `text-foreground` for text. No hardcoded hex values.
  </action>
  <verify>
Run `pnpm typecheck` — should compile without errors.
Run `pnpm lint` — should pass.
Verify both files exist and export their named components.
  </verify>
  <done>
DashboardShell component renders a two-column layout with left flexible column and right fixed ~360px panel. RightPanel shows close button for detail views and hides on mobile. Panel state managed via React Context with useDashboardPanel hook.
  </done>
</task>

</tasks>

<verification>
1. `pnpm typecheck` passes
2. `pnpm lint` passes
3. `lib/types/dashboard.ts` contains RightPanelView, SelectableJobItem, SelectableAlertItem types
4. `components/dashboard/right-panel.tsx` exports RightPanel component
5. `components/dashboard/dashboard-shell.tsx` exports DashboardShell, DashboardPanelProvider, useDashboardPanel
</verification>

<success_criteria>
- Two new component files created with proper TypeScript types
- Panel state machine supports 4 mutually exclusive views (RP-02)
- Two-column layout renders left flexible + right fixed on lg+ (DL-01 partial)
- Right panel hidden on mobile (DL-04 partial — mobile bottom sheet comes in Plan 05)
- Close button returns to default state (JD-04 partial)
- All existing functionality unchanged (no modifications to existing components)
</success_criteria>

<output>
After completion, create `.planning/phases/40-dashboard-command-center/40-01-SUMMARY.md`
</output>
