---
phase: 49-custom-services-visual-polish
plan: 02
type: execute
wave: 2
depends_on: ["49-01"]
files_modified:
  - components/jobs/job-filters.tsx
  - components/campaigns/campaign-form.tsx
  - components/onboarding/steps/business-setup-step.tsx
  - components/settings/service-types-section.tsx
autonomous: true

must_haves:
  truths:
    - "JobFilters 'Other' pill label shows custom service names when configured (not just 'Other')"
    - "CampaignForm service type selector shows custom names for the 'Other' option"
    - "Custom service name pills in onboarding render at readable size without clipping"
    - "Custom service name pills in settings render at readable size without clipping"
  artifacts:
    - "components/jobs/job-filters.tsx using customServiceNames from context"
    - "components/campaigns/campaign-form.tsx using customServiceNames from context"
    - "components/onboarding/steps/business-setup-step.tsx with readable pill rendering"
    - "components/settings/service-types-section.tsx with readable pill rendering"
  key_links:
    - "JobFilters and CampaignForm both call useBusinessSettings() — must destructure customServiceNames"
    - "JobFilters filter value remains 'other' (ServiceType) — only the display label changes"
    - "CampaignForm SelectItem value remains 'other' — only the label text changes"
    - "TagBadge pill rendering uses text-xs which is fine — container flex-wrap ensures no clipping"
---

<objective>
Propagate custom service names to remaining consumers (JobFilters, CampaignForm) and verify/fix pill rendering for custom service names in onboarding and settings.

Purpose: After Plan 01 threads customServiceNames through the provider and ServiceTypeSelect, this plan ensures the remaining UI surfaces that display service types also show custom names instead of generic "Other". The pill rendering fix ensures custom service names (which can be longer strings like "Pest Control") display at readable size.

Output: All service type selectors and filters across the app show custom service names. Pills render cleanly in onboarding and settings.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/49-custom-services-visual-polish/49-RESEARCH.md
@.planning/phases/49-custom-services-visual-polish/49-01-SUMMARY.md

Key files:
@components/jobs/job-filters.tsx
@components/campaigns/campaign-form.tsx
@components/onboarding/steps/business-setup-step.tsx
@components/settings/service-types-section.tsx
@components/ui/tag-badge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update JobFilters and CampaignForm with custom service names</name>
  <files>
    components/jobs/job-filters.tsx
    components/campaigns/campaign-form.tsx
  </files>
  <action>
**job-filters.tsx:**

1. Destructure `customServiceNames` alongside `enabledServiceTypes` from `useBusinessSettings()`:
   ```typescript
   const { enabledServiceTypes, customServiceNames } = useBusinessSettings()
   ```

2. In the service type filter pills section (the `visibleServiceTypes.map(type => ...)` block), update the label for the `'other'` type. When custom names exist, replace "Other" with a descriptive label.

   **Logic for the label:**
   - If `type === 'other'` AND `customServiceNames.length > 0`:
     - If 1 custom name: show that name (e.g., "Pest Control")
     - If 2+ custom names: show comma-joined names truncated sensibly, e.g., first name + " +N" (e.g., "Pest Control +1")
   - Otherwise: show `SERVICE_TYPE_LABELS[type]` as before

   Create a helper function inside the component or inline:
   ```typescript
   const getServiceLabel = (type: ServiceType) => {
     if (type === 'other' && customServiceNames.length > 0) {
       if (customServiceNames.length === 1) return customServiceNames[0]
       return `${customServiceNames[0]} +${customServiceNames.length - 1}`
     }
     return SERVICE_TYPE_LABELS[type]
   }
   ```

   Replace `{SERVICE_TYPE_LABELS[type]}` in the service type button with `{getServiceLabel(type)}`.

   **CRITICAL:** The filter value (`filters.serviceType`) remains `'other'` (ServiceType). Only the display label changes. The `onClick` handler still toggles `type` which is `'other'`.

**campaign-form.tsx:**

1. Destructure `customServiceNames` alongside `enabledServiceTypes` from `useBusinessSettings()`:
   ```typescript
   const { enabledServiceTypes, customServiceNames } = useBusinessSettings()
   ```

2. In the service type `<Select>` content (the `Object.entries(SERVICE_TYPE_LABELS).filter(...).map(...)` block), update the label for the 'other' entry.

   Replace the `.map(([value, label]) => ...)` to check if `value === 'other'` and custom names exist:
   ```tsx
   .map(([value, label]) => {
     const displayLabel = value === 'other' && customServiceNames.length > 0
       ? customServiceNames.join(', ')
       : label
     return (
       <SelectItem key={value} value={value}>
         {displayLabel}
       </SelectItem>
     )
   })
   ```

   If the joined custom names string is very long (3+ names), use the same truncation pattern: first name + ` +N`. But for the campaign selector, showing all names (comma-joined) is acceptable since the dropdown has more space than a filter pill.

   **CRITICAL:** The `SelectItem value` remains `'other'`. Only the display text changes. Campaign matching uses the `service_type` value, not the display label.
  </action>
  <verify>
1. `pnpm typecheck` passes
2. `pnpm lint` passes
3. Grep `customServiceNames` in job-filters.tsx and campaign-form.tsx — present in both
  </verify>
  <done>
JobFilters "Other" pill shows custom service names. CampaignForm "Other" select item shows custom service names. Filter/select values remain 'other' — only labels change.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify and fix custom service name pill rendering</name>
  <files>
    components/onboarding/steps/business-setup-step.tsx
    components/settings/service-types-section.tsx
  </files>
  <action>
The TagBadge component uses `text-xs px-2 py-0.5 rounded-full` which renders at ~12px font with 8px horizontal padding. Research indicates the pill itself is fine for most custom service names, and the containers already use `flex flex-wrap`. However, verify and improve:

**business-setup-step.tsx:**

1. Locate the custom service names display section (around line 236):
   ```tsx
   <div className="flex flex-wrap gap-1.5 pt-1">
     {customServiceNames.map((name) => (
       <TagBadge key={name} tag={name} onRemove={() => removeCustomService(name)} />
     ))}
   </div>
   ```

2. The container uses `flex flex-wrap gap-1.5 pt-1` which is correct for wrapping. Improve the gap to `gap-2` for slightly better breathing room between pills. This is a minor refinement.

3. Upgrade the TagBadge for custom services to use `text-sm` instead of the default `text-xs` for better readability of longer names. Pass a className override:
   ```tsx
   <TagBadge
     key={name}
     tag={name}
     onRemove={() => removeCustomService(name)}
     className="text-sm px-2.5 py-1"
   />
   ```

   This gives custom service name pills slightly more padding and a larger font, making them more readable than the default tag size. The `className` prop is already supported by TagBadge via `cn()`.

**service-types-section.tsx:**

1. Locate the custom service names display section (around line 189):
   ```tsx
   <div className="flex flex-wrap gap-1.5">
     {customServiceNames.map((name) => (
       <TagBadge key={name} tag={name} onRemove={() => removeCustomService(name)} />
     ))}
   </div>
   ```

2. Apply the same improvements:
   - Change gap from `gap-1.5` to `gap-2`
   - Add the same className override to TagBadge for larger pill size:
   ```tsx
   <TagBadge
     key={name}
     tag={name}
     onRemove={() => removeCustomService(name)}
     className="text-sm px-2.5 py-1"
   />
   ```

**Do NOT modify `components/ui/tag-badge.tsx`** — the base component is fine. The size upgrade is specific to custom service name contexts where names can be long. Regular tag usage (VIP, repeat, etc.) should keep the compact default size.
  </action>
  <verify>
1. `pnpm typecheck` passes
2. `pnpm lint` passes
3. Grep `text-sm px-2.5 py-1` in business-setup-step.tsx and service-types-section.tsx — className override present in both
  </verify>
  <done>
Custom service name pills render at `text-sm` (14px) with `px-2.5 py-1` padding for better readability. Containers use `gap-2` for adequate spacing. No overflow or clipping for typical names like "Pest Control" or "Pool Cleaning".
  </done>
</task>

</tasks>

<verification>
1. `pnpm typecheck` — zero errors
2. `pnpm lint` — zero errors or warnings
3. All four files reference `customServiceNames`
4. JobFilters and CampaignForm show custom names as labels but preserve `'other'` as the filter/select value
5. Pill rendering in onboarding and settings uses `text-sm px-2.5 py-1` for readability
</verification>

<success_criteria>
- Custom service names appear in job filter pills (replacing generic "Other")
- Custom service names appear in campaign service type selector (replacing generic "Other")
- Custom service name pills in onboarding render at readable size (text-sm, adequate padding)
- Custom service name pills in settings render at readable size (matching onboarding)
- No TypeScript errors, no lint errors
</success_criteria>

<output>
After completion, create `.planning/phases/49-custom-services-visual-polish/49-02-SUMMARY.md`
</output>
