---
phase: 30-v2-alignment
plan: 05
type: execute
wave: 2
depends_on: []
files_modified:
  - components/customers/customers-client.tsx
  - components/customers/empty-state.tsx
autonomous: true

must_haves:
  truths:
    - "Customers page header has NO 'Add Customer' button"
    - "Customers empty state says 'Customers appear here as you complete jobs'"
    - "Empty state CTA guides to Jobs page, not Add Customer"
    - "CSV Import button remains (for migration use case)"
  artifacts:
    - path: "components/customers/customers-client.tsx"
      provides: "Updated Customers page without Add Customer CTAs"
      min_lines: 100
    - path: "components/customers/empty-state.tsx"
      provides: "V2-aligned empty state"
      contains: "complete jobs"
  key_links:
    - from: "components/customers/empty-state.tsx"
      to: "/jobs"
      via: "Link href"
      pattern: "href=\"/jobs\""
---

<objective>
Remove "Add Customer" CTAs from Customers page and update empty state copy to reflect V2 philosophy. Customers are created as a side effect of jobs, not independently.

Purpose: V2FL-03/V2FL-04/V2UX-01/V2UX-02 requirements. De-emphasize manual customer creation.
Output: V2-aligned Customers page with no "Add Customer" buttons.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-v2-alignment/30-RESEARCH.md
@.planning/V1-TO-V2-PHILOSOPHY.md

# Existing files to modify
@components/customers/customers-client.tsx
@components/customers/empty-state.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Customers page empty state</name>
  <files>components/customers/empty-state.tsx</files>
  <action>
Update components/customers/empty-state.tsx with V2-aligned copy and CTAs:

```typescript
'use client'

import Link from 'next/link'
import { Button } from '@/components/ui/button'
import { AddressBook, Briefcase } from '@phosphor-icons/react'

export function CustomersEmptyState() {
  return (
    <div className='flex flex-col items-center justify-center py-16 px-4 text-center'>
      <div className='rounded-full bg-muted p-6 mb-6'>
        <AddressBook size={48} weight="regular" className='text-muted-foreground' />
      </div>

      <h2 className='text-2xl font-semibold tracking-tight mb-2'>
        No customers yet
      </h2>

      <p className='text-muted-foreground mb-8 max-w-md'>
        Customers appear here as you complete jobs. Ready to add your first job?
      </p>

      <div className='flex flex-col sm:flex-row gap-3'>
        <Link href="/jobs?action=add">
          <Button>
            <Briefcase className='mr-2 h-4 w-4' weight="regular" />
            Add Your First Job
          </Button>
        </Link>
      </div>

      <p className='text-sm text-muted-foreground mt-6 max-w-sm'>
        When you complete a job, a customer record is automatically created and enrolled in your review campaign.
      </p>
    </div>
  )
}
```

Key changes:
1. Icon changed from Users (lucide) to AddressBook (phosphor)
2. Description updated to V2 copy: "Customers appear here as you complete jobs"
3. Primary CTA is "Add Your First Job" linking to /jobs?action=add
4. Removed "Add Customer" button entirely
5. Added explanatory text about automatic customer creation
  </action>
  <verify>Run `pnpm typecheck` to confirm no errors</verify>
  <done>Empty state reflects V2 philosophy - customers come from jobs</done>
</task>

<task type="auto">
  <name>Task 2: Remove Add Customer button from Customers page header</name>
  <files>components/customers/customers-client.tsx</files>
  <action>
Update components/customers/customers-client.tsx to:
1. Remove "Add Customer" button from header
2. Remove AddCustomerSheet and related state
3. Keep CSV Import for migration use case (de-emphasized)
4. Update description text
5. Use V2-aligned empty state

Changes to make:

1. Remove imports:
```typescript
// REMOVE: import { Plus, Users, Loader2 } from 'lucide-react'
// ADD:
import { CircleNotch } from '@phosphor-icons/react'
```

2. Remove state for add customer sheet:
```typescript
// REMOVE these lines:
// const [addSheetOpen, setAddSheetOpen] = useState(false)
```

3. Update header section (around line 142-158):
```typescript
{/* Header */}
<div className='flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4'>
  <div>
    <h1 className='text-3xl font-bold tracking-tight'>Customers</h1>
    <p className='text-muted-foreground mt-1'>
      Customers are created automatically when you complete jobs
    </p>
  </div>

  {hasCustomers && (
    <div className='flex gap-2'>
      <CSVImportDialog />
    </div>
  )}
</div>
```

4. Replace empty state (around line 173-194):
```typescript
{/* Content */}
{hasCustomers ? (
  <CustomerTable ... />
) : (
  <CustomersEmptyState />
)}
```

5. Remove AddCustomerSheet component from JSX (around line 197-200):
```typescript
// REMOVE:
// <AddCustomerSheet
//   open={addSheetOpen}
//   onOpenChange={setAddSheetOpen}
// />
```

6. Update loading indicator to use Phosphor:
```typescript
{isPending && (
  <div className="fixed inset-0 bg-background/50 z-50 flex items-center justify-center">
    <CircleNotch className="h-8 w-8 animate-spin text-primary" />
  </div>
)}
```

7. Import the new empty state:
```typescript
import { CustomersEmptyState } from './empty-state'
```

8. Remove unused import:
```typescript
// REMOVE: import { AddCustomerSheet } from './add-customer-sheet'
```
  </action>
  <verify>Run `pnpm typecheck` to confirm no errors after removing Add Customer</verify>
  <done>Customers page header has no Add Customer button, uses V2 description</done>
</task>

</tasks>

<verification>
1. `pnpm typecheck` passes
2. `pnpm lint` passes
3. Customers page header shows NO "Add Customer" button
4. Empty state shows "Customers appear here as you complete jobs"
5. Empty state CTA goes to /jobs?action=add
6. CSV Import still available in header (when customers exist)
</verification>

<success_criteria>
- No "Add Customer" button in header (V2FL-03)
- No "Add Customer" CTA in empty state (V2FL-04)
- Empty state text is V2-aligned (V2UX-01)
- Description reflects V2 model (V2UX-02)
- Phosphor icons used consistently
</success_criteria>

<output>
After completion, create `.planning/phases/30-v2-alignment/30-05-SUMMARY.md`
</output>
