---
phase: 30-v2-alignment
plan: 08
type: execute
wave: 3
depends_on: []
files_modified:
  - components/layout/sidebar.tsx
  - components/layout/mobile-fab.tsx
  - app/(dashboard)/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Sidebar 'Add Job' button uses primary variant (not outline)"
    - "Mobile FAB for 'Add Job' visible on dashboard pages"
    - "FAB positioned above bottom nav (bottom-20 or similar)"
    - "FAB hidden on desktop (md:hidden)"
  artifacts:
    - path: "components/layout/mobile-fab.tsx"
      provides: "Mobile floating action button"
      min_lines: 30
    - path: "components/layout/sidebar.tsx"
      provides: "Updated Add Job button variant"
      contains: 'variant="default"'
  key_links:
    - from: "app/(dashboard)/layout.tsx"
      to: "components/layout/mobile-fab.tsx"
      via: "MobileFAB import"
      pattern: "MobileFAB"
---

<objective>
Update "Add Job" CTA to primary variant in sidebar and add mobile FAB for quick job creation on mobile devices.

Purpose: V2FL-07/V2FL-08 requirements. Make job creation the most prominent action.
Output: Primary Add Job button in sidebar, mobile FAB visible on dashboard pages.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-v2-alignment/30-RESEARCH.md

# Existing files
@components/layout/sidebar.tsx
@app/(dashboard)/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update sidebar Add Job button to primary variant</name>
  <files>components/layout/sidebar.tsx</files>
  <action>
In components/layout/sidebar.tsx, find the "Add Job" button section (around line 154-168) and change from outline to default variant:

BEFORE:
```typescript
<Button
  variant="outline"
  className={cn(
    "w-full justify-start gap-2 text-sm",
    collapsed && "justify-center px-2"
  )}
>
```

AFTER:
```typescript
<Button
  variant="default"
  className={cn(
    "w-full justify-start gap-2 text-sm",
    collapsed && "justify-center px-2"
  )}
>
```

This changes the button from outline (secondary appearance) to default (primary blue fill), making it the most prominent action in the sidebar per V2 philosophy.
  </action>
  <verify>Run `pnpm typecheck` and visually confirm button is now primary color</verify>
  <done>Sidebar Add Job button uses primary variant</done>
</task>

<task type="auto">
  <name>Task 2: Create MobileFAB component</name>
  <files>components/layout/mobile-fab.tsx</files>
  <action>
Create components/layout/mobile-fab.tsx:

```typescript
'use client'

import { useRouter, usePathname } from 'next/navigation'
import { Plus } from '@phosphor-icons/react'
import { cn } from '@/lib/utils'

// Pages where FAB should be hidden (Jobs page has header button)
const HIDDEN_ON_PATHS = ['/jobs']

export function MobileFAB() {
  const router = useRouter()
  const pathname = usePathname()

  // Hide on certain pages or when path matches
  const shouldHide = HIDDEN_ON_PATHS.some(p => pathname.startsWith(p))

  if (shouldHide) return null

  const handleClick = () => {
    router.push('/jobs?action=add')
  }

  return (
    <button
      onClick={handleClick}
      aria-label="Add Job"
      className={cn(
        // Positioning: fixed bottom-right, above bottom nav (72px + 8px margin)
        "fixed bottom-20 right-4 z-50",
        // Size: 56x56px (iOS standard, exceeds 44px minimum)
        "h-14 w-14",
        // Styling
        "rounded-full bg-primary text-primary-foreground shadow-lg",
        // States
        "hover:bg-primary/90 active:scale-95",
        "focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
        // Responsive: hide on desktop (sidebar has Add Job button)
        "md:hidden",
        // Transition
        "transition-all duration-200"
      )}
    >
      <div className="flex h-full w-full items-center justify-center">
        <Plus size={24} weight="bold" />
      </div>
    </button>
  )
}
```

This component:
- Shows FAB on mobile only (md:hidden)
- Positioned above bottom nav (bottom-20 = 80px)
- 56x56px size (iOS standard)
- Primary color to match sidebar button
- Hidden on Jobs page (already has header button)
- Has proper ARIA label
- Keyboard accessible with focus ring
  </action>
  <verify>Run `pnpm typecheck` to confirm component compiles</verify>
  <done>MobileFAB component created at components/layout/mobile-fab.tsx</done>
</task>

<task type="auto">
  <name>Task 3: Add MobileFAB to dashboard layout</name>
  <files>app/(dashboard)/layout.tsx</files>
  <action>
In app/(dashboard)/layout.tsx, import and add MobileFAB component:

1. Add import at top of file:
```typescript
import { MobileFAB } from '@/components/layout/mobile-fab'
```

2. Add MobileFAB to the layout JSX, after BottomNav but still inside the layout wrapper:

```typescript
export default async function DashboardLayout({
  children,
}: {
  children: React.ReactNode
}) {
  // ... existing code

  return (
    <div className="flex min-h-screen bg-background">
      <Sidebar dashboardBadge={dashboardBadge} />
      <div className="flex flex-1 flex-col">
        <main className="flex-1 p-4 md:p-6 pb-[72px] md:pb-6" id="main-content">
          {children}
        </main>
        <BottomNav />
        <MobileFAB />  {/* Add this line */}
      </div>
    </div>
  )
}
```

The MobileFAB is a client component that handles its own visibility based on pathname.
  </action>
  <verify>Run `pnpm typecheck` and verify FAB appears on mobile viewport</verify>
  <done>MobileFAB integrated into dashboard layout</done>
</task>

</tasks>

<verification>
1. `pnpm typecheck` passes
2. `pnpm lint` passes
3. Sidebar "Add Job" button has primary blue background (not outline)
4. Mobile FAB visible on mobile viewport on Dashboard, Campaigns, Analytics pages
5. Mobile FAB hidden on Jobs page
6. Mobile FAB hidden on desktop viewport
</verification>

<success_criteria>
- Sidebar Add Job button uses primary variant (V2FL-07)
- Mobile FAB visible on dashboard pages (V2FL-08)
- FAB positioned correctly above bottom nav
- FAB has accessible aria-label
</success_criteria>

<output>
After completion, create `.planning/phases/30-v2-alignment/30-08-SUMMARY.md`
</output>
