---
phase: 09-polish-ux
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/globals.css
  - app/layout.tsx
  - components/ui/skeleton.tsx
  - components/ui/sonner.tsx
  - lib/hooks/use-local-storage.ts
  - lib/hooks/use-media-query.ts
autonomous: true

must_haves:
  truths:
    - "CSS variables define light gray background (#F5F5F7), blue accent, medium radius (8-12px)"
    - "Sonner toast provider is available app-wide"
    - "Skeleton component exists with pulse animation"
    - "useLocalStorage hook handles SSR safely"
    - "useMediaQuery hook provides responsive breakpoint detection"
  artifacts:
    - path: "app/globals.css"
      provides: "Design tokens as CSS variables"
      contains: "--background: 0 0% 96%"
    - path: "components/ui/sonner.tsx"
      provides: "Sonner toast component"
      exports: ["Toaster"]
    - path: "components/ui/skeleton.tsx"
      provides: "Skeleton loading primitive"
      exports: ["Skeleton"]
    - path: "lib/hooks/use-local-storage.ts"
      provides: "SSR-safe localStorage hook"
      exports: ["useLocalStorage"]
    - path: "lib/hooks/use-media-query.ts"
      provides: "Responsive breakpoint hook"
      exports: ["useMediaQuery"]
  key_links:
    - from: "app/layout.tsx"
      to: "components/ui/sonner.tsx"
      via: "Toaster import and render"
      pattern: "import.*Toaster.*sonner"
---

<objective>
Establish the design system foundation with CSS variables, toast notifications, and utility hooks.

Purpose: Create the base layer for consistent visual design. All subsequent polish work builds on these design tokens, the toast system, and responsive hooks.

Output: Updated globals.css with design tokens, Sonner toast provider in root layout, Skeleton component, and responsive utility hooks.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-polish-ux/09-CONTEXT.md
@.planning/phases/09-polish-ux/09-RESEARCH.md
@app/globals.css
@app/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update globals.css with design tokens</name>
  <files>app/globals.css</files>
  <action>
Replace the current CSS variables in globals.css with the new design system tokens from CONTEXT.md:

Light mode (:root):
- --background: 0 0% 96% (light gray #F5F5F7)
- --foreground: 0 0% 9%
- --card: 0 0% 100% (white cards)
- --card-foreground: 0 0% 9%
- --primary: 217 91% 60% (blue accent)
- --primary-foreground: 0 0% 98%
- --muted: 0 0% 92%
- --muted-foreground: 0 0% 45%
- --accent: 217 91% 60% (match primary)
- --accent-foreground: 0 0% 98%
- --destructive: 0 84% 60%
- --destructive-foreground: 0 0% 98%
- --border: 0 0% 89%
- --input: 0 0% 89%
- --ring: 217 91% 60% (match primary)
- --radius: 0.75rem (12px for cards)

Dark mode (.dark):
- --background: 0 0% 9%
- --foreground: 0 0% 98%
- --card: 0 0% 12%
- --card-foreground: 0 0% 98%
- --primary: 217 91% 65%
- --primary-foreground: 0 0% 9%
- --muted: 0 0% 15%
- --muted-foreground: 0 0% 64%
- --border: 0 0% 20%
- --input: 0 0% 20%

Add prefers-reduced-motion support at the end:
```css
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
```
  </action>
  <verify>Run `pnpm lint` - no CSS errors. Visually check that existing pages still render (background should now be light gray instead of white).</verify>
  <done>globals.css contains new design tokens with light gray background and blue accent.</done>
</task>

<task type="auto">
  <name>Task 2: Add Sonner toast and Skeleton components</name>
  <files>components/ui/sonner.tsx, components/ui/skeleton.tsx, app/layout.tsx</files>
  <action>
1. Run shadcn CLI to add components:
   ```bash
   pnpm dlx shadcn@latest add sonner skeleton --yes
   ```

2. Update app/layout.tsx to include the Toaster provider:
   - Import `Toaster` from "@/components/ui/sonner"
   - Add `<Toaster position="top-right" richColors />` as last child inside ThemeProvider, after {children}
   - Do NOT remove existing layout structure

The Toaster should be positioned top-right per CONTEXT.md toast decisions.
  </action>
  <verify>
1. Check files exist: `ls components/ui/sonner.tsx components/ui/skeleton.tsx`
2. Run `pnpm typecheck` - no errors
3. Run `pnpm dev` and verify console shows no errors on page load
  </verify>
  <done>Sonner toast and Skeleton components installed. Toaster rendered in root layout.</done>
</task>

<task type="auto">
  <name>Task 3: Create responsive utility hooks</name>
  <files>lib/hooks/use-local-storage.ts, lib/hooks/use-media-query.ts</files>
  <action>
1. Create lib/hooks directory if it doesn't exist

2. Create use-local-storage.ts with SSR-safe localStorage hook:
```typescript
"use client"

import { useState, useEffect, useCallback } from 'react'

export function useLocalStorage<T>(
  key: string,
  initialValue: T
): [T, (value: T | ((prev: T) => T)) => void] {
  // Initialize with stored value (client) or initial value (SSR)
  const [storedValue, setStoredValue] = useState<T>(() => {
    if (typeof window === 'undefined') {
      return initialValue
    }
    try {
      const item = window.localStorage.getItem(key)
      return item ? JSON.parse(item) : initialValue
    } catch (error) {
      console.warn(`Error reading localStorage key "${key}":`, error)
      return initialValue
    }
  })

  // Sync to localStorage when value changes
  useEffect(() => {
    if (typeof window === 'undefined') return
    try {
      window.localStorage.setItem(key, JSON.stringify(storedValue))
    } catch (error) {
      console.warn(`Error setting localStorage key "${key}":`, error)
    }
  }, [key, storedValue])

  const setValue = useCallback((value: T | ((prev: T) => T)) => {
    setStoredValue(prev => {
      const newValue = value instanceof Function ? value(prev) : value
      return newValue
    })
  }, [])

  return [storedValue, setValue]
}
```

3. Create use-media-query.ts for responsive breakpoint detection:
```typescript
"use client"

import { useState, useEffect } from 'react'

export function useMediaQuery(query: string): boolean {
  const [matches, setMatches] = useState(false)

  useEffect(() => {
    const media = window.matchMedia(query)

    // Set initial value
    setMatches(media.matches)

    // Listen for changes
    const listener = (event: MediaQueryListEvent) => {
      setMatches(event.matches)
    }

    media.addEventListener('change', listener)
    return () => media.removeEventListener('change', listener)
  }, [query])

  return matches
}

// Convenience hooks matching Tailwind breakpoints
export function useIsMobile(): boolean {
  return !useMediaQuery('(min-width: 768px)')
}

export function useIsTablet(): boolean {
  return useMediaQuery('(min-width: 768px)') && !useMediaQuery('(min-width: 1024px)')
}

export function useIsDesktop(): boolean {
  return useMediaQuery('(min-width: 1024px)')
}
```
  </action>
  <verify>
1. Run `pnpm typecheck` - no errors
2. Check exports: `grep -l "export function useLocalStorage" lib/hooks/use-local-storage.ts`
3. Check exports: `grep -l "export function useMediaQuery" lib/hooks/use-media-query.ts`
  </verify>
  <done>useLocalStorage and useMediaQuery hooks created with SSR safety.</done>
</task>

</tasks>

<verification>
1. `pnpm lint && pnpm typecheck` passes
2. Files exist: globals.css, sonner.tsx, skeleton.tsx, use-local-storage.ts, use-media-query.ts
3. `pnpm dev` runs without console errors
4. Background color is light gray (#F5F5F7) in browser
5. Toast can be triggered manually from console: `import { toast } from 'sonner'; toast.success('Test')`
</verification>

<success_criteria>
- globals.css has updated design tokens (light gray background, blue accent)
- Sonner toast provider renders in root layout
- Skeleton component available for loading states
- useLocalStorage hook handles SSR safely
- useMediaQuery hook provides responsive breakpoint detection
- All lint and typecheck pass
</success_criteria>

<output>
After completion, create `.planning/phases/09-polish-ux/09-01-SUMMARY.md`
</output>
