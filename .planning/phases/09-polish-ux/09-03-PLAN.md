---
phase: 09-polish-ux
plan: 03
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - app/dashboard/loading.tsx
  - app/(dashboard)/contacts/loading.tsx
  - app/(dashboard)/send/loading.tsx
  - app/(dashboard)/history/loading.tsx
  - app/(dashboard)/billing/loading.tsx
  - components/skeletons/table-skeleton.tsx
  - components/skeletons/card-skeleton.tsx
  - components/skeletons/dashboard-skeleton.tsx
  - components/contacts/empty-state.tsx
  - components/history/empty-state.tsx
autonomous: true

must_haves:
  truths:
    - "Content loads without visible layout jumping (no CLS)"
    - "User sees meaningful placeholder during initial page load"
    - "Empty states guide user toward next action with clear CTA"
    - "Loading experience matches the structure of loaded content"
  artifacts:
    - path: "app/dashboard/loading.tsx"
      provides: "Dashboard loading skeleton"
      min_lines: 15
    - path: "app/(dashboard)/contacts/loading.tsx"
      provides: "Contacts loading skeleton"
      min_lines: 15
    - path: "components/skeletons/table-skeleton.tsx"
      provides: "Reusable table skeleton"
      exports: ["TableSkeleton"]
    - path: "components/skeletons/card-skeleton.tsx"
      provides: "Reusable card skeleton"
      exports: ["CardSkeleton"]
  key_links:
    - from: "app/(dashboard)/contacts/loading.tsx"
      to: "components/skeletons/table-skeleton.tsx"
      via: "TableSkeleton import"
      pattern: "import.*TableSkeleton"
    - from: "app/dashboard/loading.tsx"
      to: "components/skeletons/dashboard-skeleton.tsx"
      via: "DashboardSkeleton import"
      pattern: "import.*DashboardSkeleton"
---

<objective>
Add loading skeleton screens for all dashboard routes and polish empty states.

Purpose: Improve perceived performance with skeleton screens that match content structure, preventing layout shift and providing visual feedback during data loading.

Output: loading.tsx files for all dashboard routes, reusable skeleton components, polished empty states with icon + text + CTA format.
</objective>

<execution_context>
@C:\Users\aanth\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\aanth\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-polish-ux/09-CONTEXT.md
@.planning/phases/09-polish-ux/09-RESEARCH.md
@.planning/phases/09-polish-ux/09-01-SUMMARY.md
@app/dashboard/page.tsx
@app/(dashboard)/contacts/page.tsx
@app/(dashboard)/send/page.tsx
@app/(dashboard)/history/page.tsx
@app/(dashboard)/billing/page.tsx
@components/contacts/empty-state.tsx
@components/history/empty-state.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create reusable skeleton components</name>
  <files>components/skeletons/table-skeleton.tsx, components/skeletons/card-skeleton.tsx, components/skeletons/dashboard-skeleton.tsx</files>
  <action>
Create components/skeletons directory and add reusable skeleton components:

1. components/skeletons/table-skeleton.tsx:
```typescript
import { Skeleton } from '@/components/ui/skeleton'

interface TableSkeletonProps {
  rows?: number
  columns?: number
  showHeader?: boolean
  showCheckbox?: boolean
}

export function TableSkeleton({
  rows = 5,
  columns = 4,
  showHeader = true,
  showCheckbox = true,
}: TableSkeletonProps) {
  // Calculate explicit height to prevent layout shift
  const rowHeight = 73 // px per row
  const headerHeight = showHeader ? 48 : 0
  const minHeight = rows * rowHeight + headerHeight

  return (
    <div className="rounded-lg border bg-card" style={{ minHeight: `${minHeight}px` }}>
      {/* Header */}
      {showHeader && (
        <div className="flex items-center gap-4 p-4 border-b bg-muted/50">
          {showCheckbox && <Skeleton className="h-5 w-5" />}
          {Array.from({ length: columns }).map((_, i) => (
            <Skeleton key={i} className="h-4 flex-1" />
          ))}
        </div>
      )}

      {/* Rows */}
      <div className="divide-y">
        {Array.from({ length: rows }).map((_, rowIndex) => (
          <div key={rowIndex} className="flex items-center gap-4 p-4">
            {showCheckbox && <Skeleton className="h-5 w-5" />}
            {Array.from({ length: columns }).map((_, colIndex) => (
              <Skeleton
                key={colIndex}
                className={colIndex === 0 ? "h-5 flex-[2]" : "h-5 flex-1"}
              />
            ))}
          </div>
        ))}
      </div>
    </div>
  )
}
```

2. components/skeletons/card-skeleton.tsx:
```typescript
import { Skeleton } from '@/components/ui/skeleton'

interface CardSkeletonProps {
  showIcon?: boolean
  lines?: number
}

export function CardSkeleton({ showIcon = true, lines = 2 }: CardSkeletonProps) {
  return (
    <div className="rounded-lg border bg-card p-6">
      <div className="flex items-center gap-3 mb-4">
        {showIcon && <Skeleton className="h-10 w-10 rounded-lg" />}
        <Skeleton className="h-5 w-32" />
      </div>
      <div className="space-y-2">
        {Array.from({ length: lines }).map((_, i) => (
          <Skeleton key={i} className={i === 0 ? "h-8 w-24" : "h-4 w-20"} />
        ))}
      </div>
    </div>
  )
}

export function StatsCardSkeleton() {
  return (
    <div className="rounded-lg border bg-card p-6">
      <div className="flex items-center gap-3 mb-2">
        <Skeleton className="h-10 w-10 rounded-lg" />
        <Skeleton className="h-5 w-28" />
      </div>
      <Skeleton className="h-9 w-16 mb-2" />
      <Skeleton className="h-4 w-20" />
    </div>
  )
}
```

3. components/skeletons/dashboard-skeleton.tsx:
```typescript
import { Skeleton } from '@/components/ui/skeleton'
import { CardSkeleton, StatsCardSkeleton } from './card-skeleton'

export function DashboardSkeleton() {
  return (
    <div className="container mx-auto py-6 px-4">
      {/* Welcome header */}
      <div className="mb-8">
        <Skeleton className="h-8 w-64 mb-2" />
        <Skeleton className="h-5 w-96" />
      </div>

      {/* Main content grid */}
      <div className="grid gap-6 lg:grid-cols-3">
        {/* Left column */}
        <div className="lg:col-span-2 space-y-6">
          {/* Next action card */}
          <CardSkeleton lines={3} />

          {/* Stats cards */}
          <div className="grid gap-4 sm:grid-cols-2">
            <StatsCardSkeleton />
            <StatsCardSkeleton />
          </div>
        </div>

        {/* Right column */}
        <div className="space-y-6">
          {/* Checklist skeleton */}
          <div className="rounded-lg border bg-card p-6">
            <Skeleton className="h-5 w-40 mb-4" />
            <div className="space-y-3">
              {Array.from({ length: 4 }).map((_, i) => (
                <div key={i} className="flex items-center gap-3">
                  <Skeleton className="h-5 w-5 rounded" />
                  <Skeleton className="h-4 flex-1" />
                </div>
              ))}
            </div>
          </div>

          {/* Quick links skeleton */}
          <div className="rounded-lg border bg-card p-6">
            <Skeleton className="h-5 w-28 mb-4" />
            <div className="space-y-2">
              {Array.from({ length: 3 }).map((_, i) => (
                <Skeleton key={i} className="h-16 w-full rounded-lg" />
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}
```
  </action>
  <verify>
1. `pnpm typecheck` - no errors
2. Files exist: `ls components/skeletons/*.tsx`
  </verify>
  <done>Reusable skeleton components created: TableSkeleton, CardSkeleton, DashboardSkeleton.</done>
</task>

<task type="auto">
  <name>Task 2: Add loading.tsx files for all dashboard routes</name>
  <files>app/dashboard/loading.tsx, app/(dashboard)/contacts/loading.tsx, app/(dashboard)/send/loading.tsx, app/(dashboard)/history/loading.tsx, app/(dashboard)/billing/loading.tsx</files>
  <action>
Create loading.tsx files for each route:

1. app/dashboard/loading.tsx:
```typescript
import { DashboardSkeleton } from '@/components/skeletons/dashboard-skeleton'

export default function DashboardLoading() {
  return <DashboardSkeleton />
}
```

2. app/(dashboard)/contacts/loading.tsx:
```typescript
import { Skeleton } from '@/components/ui/skeleton'
import { TableSkeleton } from '@/components/skeletons/table-skeleton'

export default function ContactsLoading() {
  return (
    <div className="container py-6 space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <Skeleton className="h-8 w-32" />
        <div className="flex gap-2">
          <Skeleton className="h-10 w-28" />
          <Skeleton className="h-10 w-32" />
        </div>
      </div>

      {/* Search and filters */}
      <div className="flex gap-4">
        <Skeleton className="h-10 flex-1 max-w-sm" />
        <Skeleton className="h-10 w-32" />
      </div>

      {/* Table */}
      <TableSkeleton rows={8} columns={4} showCheckbox={true} />
    </div>
  )
}
```

3. app/(dashboard)/send/loading.tsx:
```typescript
import { Skeleton } from '@/components/ui/skeleton'

export default function SendLoading() {
  return (
    <div className="container mx-auto py-6 px-4 space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <Skeleton className="h-8 w-48" />
        <Skeleton className="h-5 w-32" />
      </div>

      {/* Contact selector */}
      <div className="rounded-lg border bg-card p-6">
        <Skeleton className="h-5 w-32 mb-4" />
        <Skeleton className="h-10 w-full mb-4" />
        <div className="grid gap-2 sm:grid-cols-2">
          {Array.from({ length: 4 }).map((_, i) => (
            <Skeleton key={i} className="h-16 w-full rounded-lg" />
          ))}
        </div>
      </div>

      {/* Message preview */}
      <div className="rounded-lg border bg-card p-6">
        <Skeleton className="h-5 w-40 mb-4" />
        <Skeleton className="h-48 w-full rounded-lg" />
      </div>

      {/* Send button */}
      <Skeleton className="h-12 w-40" />
    </div>
  )
}
```

4. app/(dashboard)/history/loading.tsx:
```typescript
import { Skeleton } from '@/components/ui/skeleton'
import { TableSkeleton } from '@/components/skeletons/table-skeleton'

export default function HistoryLoading() {
  return (
    <div className="container py-6 space-y-6">
      {/* Header */}
      <Skeleton className="h-8 w-40" />

      {/* Filters */}
      <div className="flex flex-wrap gap-4">
        <Skeleton className="h-10 w-64" />
        <Skeleton className="h-10 w-32" />
        <Skeleton className="h-10 w-40" />
        <Skeleton className="h-10 w-40" />
      </div>

      {/* Table */}
      <TableSkeleton rows={10} columns={4} showCheckbox={false} />
    </div>
  )
}
```

5. app/(dashboard)/billing/loading.tsx:
```typescript
import { Skeleton } from '@/components/ui/skeleton'
import { CardSkeleton } from '@/components/skeletons/card-skeleton'

export default function BillingLoading() {
  return (
    <div className="container mx-auto py-6 px-4 space-y-6">
      {/* Header */}
      <Skeleton className="h-8 w-48" />

      {/* Current plan card */}
      <div className="rounded-lg border bg-card p-6">
        <div className="flex items-center justify-between mb-4">
          <Skeleton className="h-6 w-32" />
          <Skeleton className="h-6 w-20 rounded-full" />
        </div>
        <div className="grid gap-6 md:grid-cols-2">
          <div>
            <Skeleton className="h-4 w-24 mb-2" />
            <Skeleton className="h-8 w-16" />
          </div>
          <div>
            <Skeleton className="h-4 w-28 mb-2" />
            <Skeleton className="h-8 w-20" />
          </div>
        </div>
      </div>

      {/* Usage cards */}
      <div className="grid gap-4 sm:grid-cols-2">
        <CardSkeleton lines={3} />
        <CardSkeleton lines={3} />
      </div>

      {/* Manage button */}
      <Skeleton className="h-10 w-40" />
    </div>
  )
}
```
  </action>
  <verify>
1. `pnpm typecheck` - no errors
2. Files exist in correct locations
3. `pnpm dev` - navigate to each route and observe skeleton during load
  </verify>
  <done>loading.tsx files added for dashboard, contacts, send, history, billing routes.</done>
</task>

<task type="auto">
  <name>Task 3: Polish empty states with icon + text + CTA format</name>
  <files>components/contacts/empty-state.tsx, components/history/empty-state.tsx</files>
  <action>
Update empty states to follow the consistent icon + text + CTA format from CONTEXT.md:

1. Read current components/contacts/empty-state.tsx and update to:
```typescript
import { Users, Plus } from 'lucide-react'
import { Button } from '@/components/ui/button'

interface ContactsEmptyStateProps {
  onAddContact?: () => void
}

export function ContactsEmptyState({ onAddContact }: ContactsEmptyStateProps) {
  return (
    <div className="flex flex-col items-center justify-center py-16 px-4 text-center">
      <div className="rounded-full bg-muted p-4 mb-4">
        <Users className="h-8 w-8 text-muted-foreground" />
      </div>
      <h3 className="text-lg font-semibold mb-2">No contacts yet</h3>
      <p className="text-muted-foreground max-w-sm mb-6">
        Add your first contact to start sending review requests. You can add them manually or import from a CSV file.
      </p>
      {onAddContact && (
        <Button onClick={onAddContact}>
          <Plus className="h-4 w-4" />
          Add Contact
        </Button>
      )}
    </div>
  )
}

// Filtered empty state when search returns no results
export function ContactsFilteredEmptyState() {
  return (
    <div className="flex flex-col items-center justify-center py-16 px-4 text-center">
      <div className="rounded-full bg-muted p-4 mb-4">
        <Users className="h-8 w-8 text-muted-foreground" />
      </div>
      <h3 className="text-lg font-semibold mb-2">No contacts found</h3>
      <p className="text-muted-foreground max-w-sm">
        Try adjusting your search or filter criteria.
      </p>
    </div>
  )
}
```

2. Read current components/history/empty-state.tsx and update to:
```typescript
import { History, Send } from 'lucide-react'
import Link from 'next/link'
import { Button } from '@/components/ui/button'

interface HistoryEmptyStateProps {
  hasFilters?: boolean
}

export function HistoryEmptyState({ hasFilters = false }: HistoryEmptyStateProps) {
  if (hasFilters) {
    return (
      <div className="flex flex-col items-center justify-center py-16 px-4 text-center">
        <div className="rounded-full bg-muted p-4 mb-4">
          <History className="h-8 w-8 text-muted-foreground" />
        </div>
        <h3 className="text-lg font-semibold mb-2">No messages found</h3>
        <p className="text-muted-foreground max-w-sm">
          Try adjusting your search or filter criteria.
        </p>
      </div>
    )
  }

  return (
    <div className="flex flex-col items-center justify-center py-16 px-4 text-center">
      <div className="rounded-full bg-muted p-4 mb-4">
        <History className="h-8 w-8 text-muted-foreground" />
      </div>
      <h3 className="text-lg font-semibold mb-2">No messages sent yet</h3>
      <p className="text-muted-foreground max-w-sm mb-6">
        Once you send your first review request, it will appear here so you can track its status.
      </p>
      <Button asChild>
        <Link href="/send">
          <Send className="h-4 w-4" />
          Send Review Request
        </Link>
      </Button>
    </div>
  )
}
```

Note: Check if these components are used and what props they expect. Match the interface to existing usage in contacts-client.tsx and history-client.tsx.
  </action>
  <verify>
1. `pnpm typecheck` - no errors
2. Check that existing usage of empty states still works
3. `pnpm dev` - view empty states (delete test data or filter to empty results)
  </verify>
  <done>Empty states polished with consistent icon + text + CTA format.</done>
</task>

</tasks>

<verification>
1. `pnpm lint && pnpm typecheck` passes
2. Each dashboard route shows skeleton on initial load
3. Skeleton screens match the structure of loaded content
4. Empty states show icon + text + CTA
5. No visible layout shift when content loads (skeletons have matching dimensions)
</verification>

<success_criteria>
- All dashboard routes have loading.tsx with skeleton screens
- Reusable skeleton components: TableSkeleton, CardSkeleton, DashboardSkeleton
- Content loads without visible layout jumping (skeletons match content dimensions)
- Empty states follow consistent icon + text + CTA format
- All lint and typecheck pass
</success_criteria>

<output>
After completion, create `.planning/phases/09-polish-ux/09-03-SUMMARY.md`
</output>
